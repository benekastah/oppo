#! /usr/bin/env coffee
# --nodejs debug

args = process.argv.slice 2

{parse} = require '../dist/parser'
rt = require '../dist/runtime'
fs = require 'fs'

parseFile = (file, cb) ->
  fs.readFile file, 'utf8', (err, data) ->
    program = parse data if data
    if args[1] is "#t"
      console.log program.toString()
    (cb or ->) rt.eval null, program
  
;parseFile "../runtime.oppo", (result) ->
parseFile args[0], (result) ->
  console.log result